(opt-6.2) D:\Karina\Optimization\OmniAnomaly>python main.py
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\session.py:71: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:76: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

Configurations
===========================================
{'batch_size': 50,
 'bf_search_max': 400.0,
 'bf_search_min': -400.0,
 'bf_search_step_size': 1.0,
 'dataset': 'machine-1-1',
 'dense_dim': 500,
 'early_stop': True,
 'get_score_on_dim': False,
 'gradient_clip_norm': 10.0,
 'initial_lr': 0.001,
 'l2_reg': 0.0001,
 'level': 0.01,
 'lr_anneal_epoch_freq': 40,
 'lr_anneal_factor': 0.5,
 'lr_anneal_step_freq': None,
 'max_epoch': 10,
 'max_test_size': None,
 'max_train_size': None,
 'nf_layers': 20,
 'posterior_flow_type': 'nf',
 'restore_dir': None,
 'result_dir': 'result',
 'rnn_cell': 'GRU',
 'rnn_num_hidden': 500,
 'save_dir': 'model',
 'save_z': False,
 'std_epsilon': 0.0001,
 'test_batch_size': 50,
 'test_n_z': 1,
 'test_score_filename': 'test_score.pkl',
 'test_start': 0,
 'train_score_filename': 'train_score.pkl',
 'train_start': 0,
 'use_connected_z_p': True,
 'use_connected_z_q': True,
 'valid_step_freq': 100,
 'window_length': 100,
 'x_dim': 38,
 'z_dim': 3}

load data of: machine-1-1
train:  0 None
test:  0 None
Data normalized
Data normalized
train set shape:  (28479, 38)
test set shape:  (28479, 38)
test set label shape:  (28479,)
WARNING:tensorflow:From main.py:100: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2024-05-21 17:43:00,414 [WARNING] tensorflow: From main.py:100: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\scope.py:56: The name tf.VariableScope is deprecated. Please use tf.compat.v1.VariableScope instead.

2024-05-21 17:43:00,419 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\scope.py:56: The name tf.VariableScope is deprecated. Please use tf.compat.v1.VariableScope instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\model.py:49: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

2024-05-21 17:43:00,447 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\model.py:49: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:107: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

2024-05-21 17:43:00,447 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:107: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:113: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2024-05-21 17:43:00,450 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:113: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\reuse.py:201: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2024-05-21 17:43:00,451 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\reuse.py:201: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\wrapper.py:105: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
2024-05-21 17:43:00,490 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\wrapper.py:105: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\wrapper.py:114: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
2024-05-21 17:43:00,491 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\wrapper.py:114: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\ops\rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
2024-05-21 17:43:00,498 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\ops\rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\ops\rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2024-05-21 17:43:00,503 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\ops\rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\ops\rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2024-05-21 17:43:00,508 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\ops\rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\wrapper.py:119: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
2024-05-21 17:43:00,929 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\wrapper.py:119: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\layers\core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
2024-05-21 17:43:00,930 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\layers\core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\zhusuan\distributions\univariate.py:100: The name tf.log is deprecated. Please use tf.math.log instead.

2024-05-21 17:43:00,983 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\zhusuan\distributions\univariate.py:100: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\zhusuan\distributions\univariate.py:167: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

2024-05-21 17:43:00,987 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\zhusuan\distributions\univariate.py:167: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\recurrent_distribution.py:101: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

2024-05-21 17:43:00,989 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\recurrent_distribution.py:101: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\recurrent_distribution.py:68: The name tf.check_numerics is deprecated. Please use tf.debugging.check_numerics instead.

2024-05-21 17:43:01,091 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\recurrent_distribution.py:68: The name tf.check_numerics is deprecated. Please use tf.debugging.check_numerics instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\layers\flows\utils.py:126: The name tf.assert_equal is deprecated. Please use tf.compat.v1.assert_equal instead.

2024-05-21 17:43:01,121 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\layers\flows\utils.py:126: The name tf.assert_equal is deprecated. Please use tf.compat.v1.assert_equal instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_probability\python\internal\distribution_util.py:542: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2024-05-21 17:43:02,282 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_probability\python\internal\distribution_util.py:542: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:123: The name tf.losses.get_regularization_loss is deprecated. Please use tf.compat.v1.losses.get_regularization_loss instead.

2024-05-21 17:43:02,457 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:123: The name tf.losses.get_regularization_loss is deprecated. Please use tf.compat.v1.losses.get_regularization_loss instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\session.py:100: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

2024-05-21 17:43:02,457 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\session.py:100: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:163: The name tf.summary.merge is deprecated. Please use tf.compat.v1.summary.merge instead.

2024-05-21 17:43:06,704 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:163: The name tf.summary.merge is deprecated. Please use tf.compat.v1.summary.merge instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:165: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2024-05-21 17:43:06,705 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:165: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

WARNING:tensorflow:From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:169: The name tf.variables_initializer is deprecated. Please use tf.compat.v1.variables_initializer instead.

2024-05-21 17:43:06,737 [WARNING] tensorflow: From D:\Karina\Optimization\OmniAnomaly\omni_anomaly\training.py:169: The name tf.variables_initializer is deprecated. Please use tf.compat.v1.variables_initializer instead.

WARNING:tensorflow:From main.py:119: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2024-05-21 17:43:06,739 [WARNING] tensorflow: From main.py:119: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2024-05-21 17:43:06.744551: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\session.py:65: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.

2024-05-21 17:43:06,747 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\session.py:65: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\session.py:127: The name tf.is_variable_initialized is deprecated. Please use tf.compat.v1.is_variable_initialized instead.

2024-05-21 17:43:07,238 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\utils\session.py:127: The name tf.is_variable_initialized is deprecated. Please use tf.compat.v1.is_variable_initialized instead.

WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\scaffold\variable_saver.py:56: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2024-05-21 17:43:08,142 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tfsnippet\scaffold\variable_saver.py:56: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

Trainable Parameters                                            (2,607,740 in total)
------------------------------------------------------------------------------------
model/q_z_given_x/rnn_q_z/rnn/gru_cell/gates/kernel             (538, 1000)  538,000
model/q_z_given_x/rnn_q_z/rnn/gru_cell/gates/bias               (1000,)        1,000
model/q_z_given_x/rnn_q_z/rnn/gru_cell/candidate/kernel         (538, 500)   269,000
model/q_z_given_x/rnn_q_z/rnn/gru_cell/candidate/bias           (500,)           500
model/q_z_given_x/rnn_q_z/dense/kernel                          (500, 500)   250,000
model/q_z_given_x/rnn_q_z/dense/bias                            (500,)           500
model/q_z_given_x/rnn_q_z/dense_1/kernel                        (500, 500)   250,000
model/q_z_given_x/rnn_q_z/dense_1/bias                          (500,)           500
model/vae/variational/z_mean/kernel                             (503, 3)       1,509
model/vae/variational/z_mean/bias                               (3,)               3
model/vae/variational/z_std/kernel                              (503, 3)       1,509
model/vae/variational/z_std/bias                                (3,)               3
model/posterior_flow/_0/w                                       (1, 3)             3
model/posterior_flow/_0/b                                       (1,)               1
model/posterior_flow/_0/u                                       (1, 3)             3
model/posterior_flow/_1/w                                       (1, 3)             3
model/posterior_flow/_1/b                                       (1,)               1
model/posterior_flow/_1/u                                       (1, 3)             3
model/posterior_flow/_2/w                                       (1, 3)             3
model/posterior_flow/_2/b                                       (1,)               1
model/posterior_flow/_2/u                                       (1, 3)             3
model/posterior_flow/_3/w                                       (1, 3)             3
model/posterior_flow/_3/b                                       (1,)               1
model/posterior_flow/_3/u                                       (1, 3)             3
model/posterior_flow/_4/w                                       (1, 3)             3
model/posterior_flow/_4/b                                       (1,)               1
model/posterior_flow/_4/u                                       (1, 3)             3
model/posterior_flow/_5/w                                       (1, 3)             3
model/posterior_flow/_5/b                                       (1,)               1
model/posterior_flow/_5/u                                       (1, 3)             3
model/posterior_flow/_6/w                                       (1, 3)             3
model/posterior_flow/_6/b                                       (1,)               1
model/posterior_flow/_6/u                                       (1, 3)             3
model/posterior_flow/_7/w                                       (1, 3)             3
model/posterior_flow/_7/b                                       (1,)               1
model/posterior_flow/_7/u                                       (1, 3)             3
model/posterior_flow/_8/w                                       (1, 3)             3
model/posterior_flow/_8/b                                       (1,)               1
model/posterior_flow/_8/u                                       (1, 3)             3
model/posterior_flow/_9/w                                       (1, 3)             3
model/posterior_flow/_9/b                                       (1,)               1
model/posterior_flow/_9/u                                       (1, 3)             3
model/posterior_flow/_10/w                                      (1, 3)             3
model/posterior_flow/_10/b                                      (1,)               1
model/posterior_flow/_10/u                                      (1, 3)             3
model/posterior_flow/_11/w                                      (1, 3)             3
model/posterior_flow/_11/b                                      (1,)               1
model/posterior_flow/_11/u                                      (1, 3)             3
model/posterior_flow/_12/w                                      (1, 3)             3
model/posterior_flow/_12/b                                      (1,)               1
model/posterior_flow/_12/u                                      (1, 3)             3
model/posterior_flow/_13/w                                      (1, 3)             3
model/posterior_flow/_13/b                                      (1,)               1
model/posterior_flow/_13/u                                      (1, 3)             3
model/posterior_flow/_14/w                                      (1, 3)             3
model/posterior_flow/_14/b                                      (1,)               1
model/posterior_flow/_14/u                                      (1, 3)             3
model/posterior_flow/_15/w                                      (1, 3)             3
model/posterior_flow/_15/b                                      (1,)               1
model/posterior_flow/_15/u                                      (1, 3)             3
model/posterior_flow/_16/w                                      (1, 3)             3
model/posterior_flow/_16/b                                      (1,)               1
model/posterior_flow/_16/u                                      (1, 3)             3
model/posterior_flow/_17/w                                      (1, 3)             3
model/posterior_flow/_17/b                                      (1,)               1
model/posterior_flow/_17/u                                      (1, 3)             3
model/posterior_flow/_18/w                                      (1, 3)             3
model/posterior_flow/_18/b                                      (1,)               1
model/posterior_flow/_18/u                                      (1, 3)             3
model/posterior_flow/_19/w                                      (1, 3)             3
model/posterior_flow/_19/b                                      (1,)               1
model/posterior_flow/_19/u                                      (1, 3)             3
model/p_x_given_z/hidden/rnn_p_x/rnn/gru_cell/gates/kernel      (503, 1000)  503,000
model/p_x_given_z/hidden/rnn_p_x/rnn/gru_cell/gates/bias        (1000,)        1,000
model/p_x_given_z/hidden/rnn_p_x/rnn/gru_cell/candidate/kernel  (503, 500)   251,500
model/p_x_given_z/hidden/rnn_p_x/rnn/gru_cell/candidate/bias    (500,)           500
model/p_x_given_z/hidden/rnn_p_x/dense/kernel                   (500, 500)   250,000
model/p_x_given_z/hidden/rnn_p_x/dense/bias                     (500,)           500
model/p_x_given_z/hidden/rnn_p_x/dense_1/kernel                 (500, 500)   250,000
model/p_x_given_z/hidden/rnn_p_x/dense_1/bias                   (500,)           500
model/p_x_given_z/x_mean/kernel                                 (500, 38)     19,000
model/p_x_given_z/x_mean/bias                                   (38,)             38
model/p_x_given_z/x_std/kernel                                  (500, 38)     19,000
model/p_x_given_z/x_std/bias                                    (38,)             38

train_values: (19936, 38)
[Epoch 1/10, Step 100] step time: 1.178s (±6.318s); train time: 54.56s; valid time: 1m 3.246s; loss: 2.60911 (±320.456); valid loss: -22.3207 (*)
[Epoch 1/10, Step 200] step time: 1.132s (±5.925s); train time: 53.75s; valid time: 59.52s; loss: -49.108 (±4.95997); valid loss: -18.2805
[Epoch 1/10, Step 300] step time: 1.171s (±5.991s); train time: 56.91s; valid time: 1m 0.2106s; loss: -52.5845 (±5.4578); valid loss: -23.1481 (*)
train_values: (19936, 38)
WARNING:tensorflow:From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\training\saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
2024-05-21 17:50:38,165 [WARNING] tensorflow: From C:\Users\megav\anaconda3\envs\opt-6.2\lib\site-packages\tensorflow_core\python\training\saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[Epoch 2/10, Step 400, ETA 1h 6m 50.61s] step time: 1.024s (±4.909s); train time: 1.861s; valid time: 49.41s; loss: -54.1487 (±12.8044); valid loss: -30.3797 (*)
[Epoch 2/10, Step 500, ETA 1h 4m 29.81s] step time: 1.086s (±6.062s); train time: 47.77s; valid time: 1m 0.8243s; loss: 6.68252 (±631.307); valid loss: -26.4103
[Epoch 2/10, Step 600, ETA 1h 3m 14.96s] step time: 1.184s (±6.066s); train time: 57.49s; valid time: 1m 0.9606s; loss: -53.4003 (±20.2069); valid loss: -24.7452
[Epoch 2/10, Step 700, ETA 1h 1m 26.98s] step time: 1.14s (±5.745s); train time: 56.26s; valid time: 57.75s; loss: -55.8052 (±18.0712); valid loss: -35.0777 (*)
train_values: (19936, 38)
[Epoch 3/10, Step 800, ETA 59m 45.62s] step time: 1.16s (±5.907s); train time: 4.567s; valid time: 59.37s; loss: -58.6266 (±5.74917); valid loss: -22.7412
[Epoch 3/10, Step 900, ETA 57m 59.02s] step time: 1.155s (±5.765s); train time: 57.56s; valid time: 57.93s; loss: -57.4591 (±5.74733); valid loss: -33.7344
[Epoch 3/10, Step 1000, ETA 56m 15.94s] step time: 1.173s (±5.943s); train time: 57.54s; valid time: 59.74s; loss: -59.7089 (±4.86026); valid loss: -18.8605
[Epoch 3/10, Step 1100, ETA 54m 27.84s] step time: 1.163s (±5.942s); train time: 56.63s; valid time: 59.71s; loss: -60.0084 (±4.39899); valid loss: 42.7654
train_values: (19936, 38)
[Epoch 4/10, Step 1200, ETA 52m 30.05s] step time: 1.127s (±5.476s); train time: 6.862s; valid time: 55.04s; loss: -60.6607 (±6.46132); valid loss: -49.3543 (*)
[Epoch 4/10, Step 1300, ETA 50m 3.422s] step time: 0.9822s (±5.015s); train time: 47.86s; valid time: 50.39s; loss: -60.767 (±7.34726); valid loss: -25.466
[Epoch 4/10, Step 1400, ETA 48m 22.23s] step time: 1.193s (±6.182s); train time: 57.17s; valid time: 1m 2.149s; loss: -64.9963 (±4.08057); valid loss: -34.0404
[Epoch 4/10, Step 1500, ETA 46m 41.21s] step time: 1.209s (±6.162s); train time: 58.98s; valid time: 1m 1.917s; loss: -62.9936 (±4.33558); valid loss: -31.8634
train_values: (19936, 38)
[Epoch 5/10, Step 1600, ETA 44m 53.12s] step time: 1.177s (±5.986s); train time: 9.154s; valid time: 1m 0.1637s; loss: -62.5864 (±5.11155); valid loss: -31.2772
[Epoch 5/10, Step 1700, ETA 43m 4.311s] step time: 1.181s (±5.996s); train time: 57.83s; valid time: 1m 0.2758s; loss: -62.0133 (±6.16999); valid loss: -22.1584
[Epoch 5/10, Step 1800, ETA 41m 5.6s] step time: 1.107s (±5.34s); train time: 57.06s; valid time: 53.66s; loss: -61.5218 (±8.24861); valid loss: -34.832
[Epoch 5/10, Step 1900, ETA 39m 14.37s] step time: 1.168s (±6s); train time: 56.55s; valid time: 1m 0.2927s; loss: -65.871 (±4.06005); valid loss: -49.1713
train_values: (19936, 38)
[Epoch 6/10, Step 2000, ETA 37m 23.3s] step time: 1.175s (±5.973s); train time: 11.4s; valid time: 1m 0.04067s; loss: -65.8786 (±5.04946); valid loss: -44.8536
[Epoch 6/10, Step 2100, ETA 35m 19.06s] step time: 1.034s (±5.87s); train time: 44.4s; valid time: 59.01s; loss: -66.5842 (±4.13173); valid loss: -44.1336
[Epoch 6/10, Step 2200, ETA 33m 26.12s] step time: 1.151s (±5.856s); train time: 56.23s; valid time: 58.94s; loss: -63.8329 (±6.46245); valid loss: 71.1948
[Epoch 6/10, Step 2300, ETA 31m 32.78s] step time: 1.148s (±5.792s); train time: 56.65s; valid time: 58.22s; loss: -68.5322 (±4.14299); valid loss: -46.664
train_values: (19936, 38)
[Epoch 7/10, Step 2400, ETA 29m 40.78s] step time: 1.171s (±5.866s); train time: 13.73s; valid time: 58.95s; loss: -66.5296 (±7.22248); valid loss: -57.4303 (*)
[Epoch 7/10, Step 2500, ETA 27m 49.84s] step time: 1.196s (±6.321s); train time: 56.14s; valid time: 1m 3.505s; loss: -67.9087 (±4.71469); valid loss: -52.3341
[Epoch 7/10, Step 2600, ETA 25m 58.17s] step time: 1.195s (±6.224s); train time: 57s; valid time: 1m 2.532s; loss: -69.4599 (±5.4857); valid loss: -51.799
[Epoch 7/10, Step 2700, ETA 24m 6.7s] step time: 1.212s (±6.102s); train time: 59.89s; valid time: 1m 1.338s; loss: -69.6356 (±5.99599); valid loss: -54.1786
train_values: (19936, 38)
[Epoch 8/10, Step 2800, ETA 22m 11.64s] step time: 1.142s (±5.327s); train time: 15.94s; valid time: 53.55s; loss: -69.2346 (±5.07732); valid loss: -20.9005
[Epoch 8/10, Step 2900, ETA 20m 22.11s] step time: 1.292s (±6.037s); train time: 1m 8.444s; valid time: 1m 0.7768s; loss: -71.1472 (±6.83757); valid loss: -48.3349
[Epoch 8/10, Step 3000, ETA 18m 22.65s] step time: 1.022s (±4.651s); train time: 55.5s; valid time: 46.75s; loss: -69.4531 (±8.56003); valid loss: -43.2265
[Epoch 8/10, Step 3100, ETA 16m 21.49s] step time: 0.9212s (±4.592s); train time: 45.99s; valid time: 46.16s; loss: -71.84 (±5.50513); valid loss: -46.9729
train_values: (19936, 38)
[Epoch 9/10, Step 3200, ETA 14m 22.65s] step time: 0.9426s (±4.758s); train time: 15.14s; valid time: 47.77s; loss: -71.0043 (±5.40507); valid loss: -51.8447
[Epoch 9/10, Step 3300, ETA 12m 26.11s] step time: 0.983s (±4.923s); train time: 48.84s; valid time: 49.5s; loss: -70.0545 (±6.3288); valid loss: -45.7754
[Epoch 9/10, Step 3400, ETA 10m 30.59s] step time: 0.98s (±4.875s); train time: 49.04s; valid time: 48.99s; loss: -69.4335 (±7.58809); valid loss: -23.0474
[Epoch 9/10, Step 3500, ETA 8m 35.94s] step time: 0.9705s (±4.83s); train time: 48.53s; valid time: 48.54s; loss: -72.8155 (±5.93343); valid loss: -50.8906
train_values: (19936, 38)
[Epoch 10/10, Step 3600, ETA 6m 42.32s] step time: 0.9754s (±4.832s); train time: 17.95s; valid time: 48.57s; loss: -73.6683 (±3.92104); valid loss: -44.5596
[Epoch 10/10, Step 3700, ETA 4m 49.44s] step time: 0.957s (±4.774s); train time: 47.73s; valid time: 47.99s; loss: -72.8004 (±4.96327); valid loss: -55.8187
[Epoch 10/10, Step 3800, ETA 2m 57.78s] step time: 1.034s (±5.558s); train time: 47.48s; valid time: 55.9s; loss: -69.5867 (±6.34867); valid loss: -48.6776
[Epoch 10/10, Step 3900, ETA 1m 6.721s] step time: 1.145s (±5.759s); train time: 56.62s; valid time: 57.88s; loss: -72.3626 (±5.31733); valid loss: -51.725
INFO:tensorflow:Restoring parameters from C:\Users\megav\AppData\Local\Temp\tmp9i73mawm\variables.dat-2400
2024-05-21 18:56:00,221 [INFO] tensorflow: Restoring parameters from C:\Users\megav\AppData\Local\Temp\tmp9i73mawm\variables.dat-2400
------------------------------ testing ------------------------------
search range:  -400.0 400.0
cur thr:  -399.0 [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  -349.0 [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  -299.0 [0.9983230661696932, 0.9992562253653542, 0.9974016295567868, 2687.0, 25684.0, 2.0, 7.0, 108.59782804343914] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  -249.0 [0.9983230661696932, 0.9992562253653542, 0.9974016295567868, 2687.0, 25684.0, 2.0, 7.0, 108.59782804343914] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  -199.0 [0.9983230661696932, 0.9992562253653542, 0.9974016295567868, 2687.0, 25684.0, 2.0, 7.0, 108.59782804343914] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  -149.0 [0.9981376411936953, 0.9988847546509859, 0.9974016295567868, 2687.0, 25683.0, 3.0, 7.0, 108.59782804343914] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  -99.0 [0.9962871728296028, 0.9951851814993141, 0.9974016295567868, 2687.0, 25673.0, 13.0, 7.0, 92.39815203695926] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  -49.0 [0.9806871657561785, 0.9628040022789556, 0.9992576057934015, 2692.0, 25582.0, 104.0, 2.0, 21.999685718775446] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  1.0 [0.8480983710244666, 0.7362667375341165, 0.9999999962880475, 2694.0, 24721.0, 965.0, 0.0, 3.74995312558593] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  51.0 [0.19182395629407076, 0.1060880522540411, 0.9999999962880475, 2694.0, 2986.0, 22700.0, 0.0, 0.0] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  101.0 [0.17339096312597815, 0.0949260041948816, 0.9999999962880475, 2694.0, 0.0, 25686.0, 0.0, 0.0] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  151.0 [0.17339096312597815, 0.0949260041948816, 0.9999999962880475, 2694.0, 0.0, 25686.0, 0.0, 0.0] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  201.0 [0.17339096312597815, 0.0949260041948816, 0.9999999962880475, 2694.0, 0.0, 25686.0, 0.0, 0.0] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  251.0 [0.17339096312597815, 0.0949260041948816, 0.9999999962880475, 2694.0, 0.0, 25686.0, 0.0, 0.0] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  301.0 [0.17339096312597815, 0.0949260041948816, 0.9999999962880475, 2694.0, 0.0, 25686.0, 0.0, 0.0] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
cur thr:  351.0 [0.17339096312597815, 0.0949260041948816, 0.9999999962880475, 2694.0, 0.0, 25686.0, 0.0, 0.0] [0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
[0.9985085600516392, 0.999627972471622, 0.9974016295567868, 2687.0, 25685.0, 1.0, 7.0, 108.59782804343914] -399.0
Initial threshold : 22.93328
Number of peaks : 283
Grimshaw maximum log-likelihood estimation ... [done]
        γ = 0
        σ = 91.759224
        L = 1561.9245483201667
Extreme quantile (probability = 0.001): 233.95767803634936
100%|███████████████████████████████████████████████████████████████████████| 28380/28380 [00:00<00:00, 3609726.70it/s]
642
28380
POT result:  (0.9578616721630142, 0.9191402220431927, 0.9999999962880475, 2694.0, 25449.0, 237.0, 0.0) -23.84786871234563 3.74995312558593
==============================result==============================
{'FN': 7.0,
 'FP': 1.0,
 'TN': 25685.0,
 'TP': 2687.0,
 'best-f1': 0.9985085600516392,
 'best_valid_loss': -57.430289481641665,
 'latency': 108.59782804343914,
 'pot-FN': 0.0,
 'pot-FP': 237.0,
 'pot-TN': 25449.0,
 'pot-TP': 2694.0,
 'pot-f1': 0.9578616721630142,
 'pot-latency': 3.74995312558593,
 'pot-precision': 0.9191402220431927,
 'pot-recall': 0.9999999962880475,
 'pot-threshold': -23.84786871234563,
 'precision': 0.999627972471622,
 'pred_time': 0.3746703712033554,
 'pred_total_time': 212.93696284294128,
 'recall': 0.9974016295567868,
 'threshold': -399.0,
 'train_time': 437.3810481548309,
 'valid_time': 0.33386849796368673}

(opt-6.2) D:\Karina\Optimization\OmniAnomaly>